<!DOCTYPE HTML>
<html>
  <head>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js'></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>
  </head>
  <body>
     <script>
      if(Cookies.get('password') != undefined)
        signIn(Cookies.get('password'));
      function signIn(passcode){
        let xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            $('#message').text(this.responseText == 'User not found' ? this.responseText : 'Welcome, ' + this.responseText);
           Cookies.set('password', passcode);
          }
        }
        xmlhttp.open('GET', 'sheets.php?signIn='+passcode, true);
        xmlhttp.send();
      }

      function getData(passcode) {
        let xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            console.log(this.responseText);
          }
        }
        xmlhttp.open('GET', 'sheets.php?q='+passcode, true);
        xmlhttp.send();
      }

      function createUser(name, passcode) {
          let xmlhttp = new XMLHttpRequest();
          xmlhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
              alert(this.responseText == 'User already exists' ? this.responseText : 'Successfully added user ' + this.responseText);
            }
          }
          xmlhttp.open('GET', 'sheets.php?createUser=' + name + '&passcode=' + passcode, true);
          xmlhttp.send();
        }
      
    </script>
    login:
    <br>
    password: <input id='password'>
    <button onclick="signIn($('#password').val())">submit</button>
    <br><br>
    add user: 
    <br>
    name: <input id='name'>
    password: <input id='passcode'>
    <button onclick="createUser($('#name').val(), $('#passcode').val())">sign in</button>
    <p id='message'>you are not logged in</p>
  </body>
</html>
